# cv-work

> A homework~

## task1



## task2

**INFO:** 主要研究 tinyface 的检测，使用之前较为流行的 Tiny-Face (论文 [Finding Tiny Faces](https://arxiv.org/abs/1612.04402))，以及 YOLO5Face (论文 [Why Reinventing a Face Detector](https://arxiv.org/abs/2105.12931)) 作为对比实验。

(1). 模型配置及使用：

* Tiny-Face 采用：HR-ResNet101 结构 
* Yolov5-Face 采用：ShuffleNetv2 作为骨架的 ***YOLOv5n***

(2). 二者在 **原论文** 的表现（使用 WIDERFace 数据集的 val 部分）：

|     Name     | Easy  | Medium | Hard  |
| :----------: | :---: | :----: | :---: |
| HR-ResNet101 | 0.919 | 0.908  | 0.823 |
|   yolov5n    | 0.936 | 0.915  | 0.805 |

(3). 实验准备：

* 下载：WIDER 数据集
  * 为了简便实验流程，我们只需要在验证集上测试两种模型性能
    * 将数据集 WIDER 放到 `/cv-work/data`
    * 将 wider_val.txt 放到 `/cv-work/data/WIDER/WIDER_val`
* 环境：
  * `conda create -n {name} python=3.11`
  * `conda activate {name}`
* Tiny-Face
  * 在 `/cv-work/task2/weights` 目录下放置 [checkpoint_50.pth](https://www.dropbox.com/scl/fi/md0lxok2uh2achx8r58mk/checkpoint_50.pth?rlkey=9y1acwj1k6c57tqck14t6as18&e=1&dl=0) 
* Yolov5-Face
  * 在 `/cv-work/task2/weights` 目录下放置 [yolov5n-face.pt](https://drive.google.com/file/d/18oenL6tjFkdR1f5IgpYeQfDFqU4w3jEr/view?usp=sharing)



> 项目结构

```
# task2
- tiny-face
- data
	- WIDER
		- ...
		- WIDER_val
			- images
			- wider_val.txt
- yolov5-face
- weights
	- checkpoint_50.pth
	- yolov5n-face.pt
```



(4). 一键实验

当你处理好了 Python 环境时，那么我们可以使用：

1. `make exp1` 以及 `make exp2` 分别获取 tiny-face 以及 yolov5-face 结果
2. `make test1` 以及 `make test2` 分别获取他们的 MAp 结果

